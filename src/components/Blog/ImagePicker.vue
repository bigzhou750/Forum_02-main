<template>
  <el-upload  v-model:file-list="fileList"
    list-type="picture-card"
    :on-preview="handlePictureCardPreview" :on-remove="handleRemove" :auto-upload="false">
    <el-icon size="60">
      <svg t="1678559910456" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="9981" width="200" height="200"><path d="M956.351785 841.786005c3.796466 15.182794 3.006474 29.577642-2.371 43.180452-5.379521 13.603833-13.761422 25.622564-25.151843 36.062334s-25.305339 18.667152-41.754986 24.676006c-16.449647 6.009877-34.167171 9.015328-53.146431 9.015328-119.579469 0.633427-226.499617 0.950651-320.771701 0.950651L190.485891 955.670775c-22.779819 0-42.868343-4.113691-60.263525-12.341073-17.400299-8.222265-31.318286-18.345834-41.760103-30.365588-10.43977-12.023848-17.400299-25.15082-20.875446-39.388079-3.479241-14.232143-3.007497-27.048029 1.421372-38.433334 3.796466-8.855692 7.593955-18.033725 11.390421-27.522844 3.163039-8.222265 6.960529-17.557888 11.385305-27.993564 4.429893-10.43977 9.172917-21.038152 14.237259-31.794124l36.062334-87.311555 108.192118 0-40.809451 119.577423 611.17679 0-40.809451-119.577423 103.445 0c13.285584 32.269961 25.305339 61.372789 36.06131 87.311555 4.429893 11.390421 8.854669 22.458501 13.286608 33.215496 4.429893 10.756995 8.379854 20.404726 11.861142 28.944216 3.479241 8.544607 6.326079 15.820314 8.543583 21.830191C955.242522 837.83195 956.351785 841.152579 956.351785 841.786005L956.351785 841.786005zM478.989677 88.739067c11.391445-13.915941 22.300912-20.716834 32.740682-20.400632 10.440793 0.312108 21.355377 7.746428 32.741705 22.300912 12.656251 15.815197 27.048029 34.636868 43.178405 56.467059 16.138562 21.825075 32.587186 44.288692 49.354058 67.381643 16.766872 23.092951 33.056883 45.393863 48.873104 66.907852 15.816221 21.509896 29.736255 39.857776 41.754986 55.041594 11.390421 14.552437 14.713097 26.414603 9.965979 35.586496-4.744048 9.17701-15.659655 13.761422-32.741705 13.761422-10.122545 0-21.982664 0.316202-35.58752 0.950651-13.602809 0.633427-25.149796 0.949628-34.640961 0.949628-13.286608-0.633427-21.826098 4.584412-25.621541 15.658631-3.796466 11.072173-5.692652 25.780153-5.692652 44.131103l0 44.601824c0 16.448624-0.158612 32.903388-0.474814 49.353035-0.318248 16.449647-0.475837 31.948643-0.475837 46.502104l0 37.011962c-0.633427 21.508873-4.588505 37.166481-11.862165 46.973848-7.275707 9.806343-21.35333 14.71105-42.233893 14.71105-14.548344 0-27.364231-0.158612-38.434358-0.474814-11.073196-0.318248-23.251563-0.475837-36.537148-0.475837-11.390421 0-20.404726-1.89721-27.048029-5.692652-6.643304-3.797489-11.706623-8.53949-15.186887-14.237259-3.480264-5.692652-5.692652-12.018731-6.643304-18.97926-0.945535-6.960529-1.421372-13.602809-1.421372-19.929912 0-14.554484 0.157589-30.369681 0.475837-47.451732 0.316202-17.083074 0.475837-34.479279 0.475837-52.195779 0-17.7165 0.156566-34.958186 0.469698-51.724035 0.317225-16.766872 0.474814-32.107255 0.474814-46.027289 0-12.653181-1.578961-22.775726-4.742001-30.369681-3.164063-7.589862-11.073196-11.386328-23.727401-11.386328-11.390421 0-25.621541-0.474814-42.703591-1.425466-17.083074-0.951675-30.686906-1.108241-40.809451-0.474814-18.35095 0-29.102828-5.535063-32.264844-16.607236-3.164063-11.069103 2.52859-25.146727 17.077957-42.231847 12.656251-15.815197 27.047006-34.481326 43.180452-55.992245 16.137539-21.511943 32.42755-43.339064 48.879244-65.485457 16.447601-22.1423 32.422434-43.655266 47.922453-64.530712C453.210547 120.058376 466.969922 102.659101 478.989677 88.739067L478.989677 88.739067zM478.989677 666.217361" fill="#515151" p-id="9982"></path></svg>
    </el-icon>
  </el-upload>

  <el-dialog v-model="dialogVisible">
    <img w-full :src="dialogImageUrl" alt="Preview Image" />
  </el-dialog>
</template>

  
<script  lang="ts" setup>
import { onMounted, ref } from 'vue'
import { Plus } from '@element-plus/icons-vue'

import type { UploadProps, UploadUserFile, UploadInstance } from 'element-plus'
import {  uploadImages } from '../../api/user_api';

const fileList = ref<UploadUserFile[]>([
])

const dialogImageUrl = ref('')
const dialogVisible = ref(false)
// const imageRef = ref<UploadInstance>()
const handleRemove = (uploadFile, uploadFiles) => {
  console.log(uploadFile, uploadFiles)
}

const handlePictureCardPreview = (uploadFile) => {
  dialogImageUrl.value = uploadFile.url
  dialogVisible.value = true
}


async function upload() {
  // console.log("formdata", fileList.value[0])
  const image_list = await uploadImages(fileList.value)
  return image_list
}
defineExpose({
  upload
});
</script>
  